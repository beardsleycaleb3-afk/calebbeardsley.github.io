
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Caleb Beardsley | oO0+ Triad Core</title>
<meta name="viewport" content="width=device-width">
<link rel="manifest" href="manifest.json">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font:14px/1.4 'Courier New',monospace;background:#000;color:#0f0;overflow:hidden}
.console{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center,#000 0%,#0a0a1a 100%)}
.header{position:absolute;top:20px;left:50%;transform:translateX(-50%);text-align:center;text-shadow:0 0 20px #0f0}
h1{font-size:28px;letter-spacing:6px}
#unlock{position:absolute;top:120px;left:50%;transform:translateX(-50%);padding:12px 24px;background:rgba(0,255,0,0.3);border:2px solid #0f0;color:#0f0;font-family:inherit;font-size:14px;cursor:pointer;display:none}
#unlock:hover{background:rgba(0,255,0,0.5);box-shadow:0 0 30px #0f0}
.preset-btn{position:absolute;top:170px;font-size:12px;padding:8px 16px;background:rgba(0,20,0,0.8);border:1px solid #0f0;color:#0f0;cursor:pointer;transition:all 0.3s}
.preset-btn:hover{box-shadow:0 0 20px #0f0;background:rgba(0,50,0,0.9)}
#demo{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:90vmin;height:90vmin;border:2px solid #0f0;box-shadow:0 0 100px rgba(0,255,0,0.3)}
.status{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:20px;font-size:11px}
.stat{background:rgba(0,0,0,0.7);padding:8px 12px;border:1px solid #0f0}
.footer{position:absolute;bottom:5px;left:50%;transform:translateX(-50%);color:#444;font-size:10px}
@media (max-width:768px){h1{font-size:22px}.preset-btn{top:160px;font-size:11px;padding:6px 12px}}
</style>
</head>
<body>
<div class="console">
  <div class="header">
    <h1>oO0+ COUNTER-ROTATING TRIAD</h1>
    <div style="font-size:12px;margin-top:5px">Core↻ Mantle↺ Crust↻ | G81 Z500→0 | Wind Spirals</div>
    <button id="unlock">► ACTIVATE COUNTER-ROTATION</button>
  </div>
  
  <button class="preset-btn" style="left:20px" onclick="loadPreset(0)">Beethoven</button>
  <button class="preset-btn" style="left:140px" onclick="loadPreset(1)">Bach</button>
  <button class="preset-btn" style="left:260px" onclick="loadPreset(2)">Toccata</button>
  <button class="preset-btn" style="left:400px" onclick="loadPreset(3)">Moonlight</button>
  <button class="preset-btn" style="left:540px" onclick="loadPreset(4)">Symphony</button>
  <button class="preset-btn" style="right:20px" onclick="loadPreset(5)">Chaos</button>
  
  <canvas id="demo" width="900" height="900"></canvas>
  
  <div class="status">
    <div class="stat">Tools: <span id="notes">0</span></div>
    <div class="stat">RPM: <span id="rpm">0</span></div>
    <div class="stat">Cycle: <span id="preset">-</span></div>
  </div>
  
  <div class="footer">© Caleb Beardsley 2026 | Counter-Rotating Platonic Solids | CNC G81 Collapse</div>
</div>

<script>
const canvas=document.getElementById('demo');
const ctx=canvas.getContext('2d');
let t=0, particles=[], preset=0, globalRPM=0;
let audioCtx, audioUnlocked=false, songProgress=0;

const songTiming={
  0:[0.1,0.3,0.6,1.1,1.8,2.4,3.0],
  1:[0.15,0.4,0.7,1.2,1.9,2.5,3.1],
  2:[0.2,0.45,0.75,1.3,2.0,2.6,3.2],
  3:[0.12,0.35,0.65,1.15,1.85,2.45,3.05],
  4:[0.18,0.42,0.72,1.25,1.95,2.55,3.15],
  5:[0.05,0.25,0.55,1.05,1.75,2.35,2.95]
};

const presets=[
  [[220,277,440,329,523],0.38,2.0,'Beethoven'],
  [[261,349,392,466,523],0.32,1.8,'Bach'],
  [[123,155,196,246,293],0.42,2.2,'Toccata'],
  [[130,174,207,261,349],0.35,1.9,'Moonlight'],
  [[196,293,392,440,523],0.30,2.1,'Symphony'],
  [[110,165,220,330,440],0.25,1.5,'Chaos']
];

let currentNotes=presets[0][0], decay=2.0;

class CNCTool {
  constructor(launchTime) {
    this.launchT=launchTime;
    this.z=500;
    this.rpm=80+Math.random()*320;
    this.spinAngle=0;
    this.x=(Math.random()-0.5)*900;
    this.y=(Math.random()-0.5)*900;
    this.vx=(Math.random()-0.5)*1.2;
    this.vy=(Math.random()-0.5)*1.2;
    this.windAngle=Math.random()*Math.PI*2;
    this.layer=Math.floor(Math.random()*3);
    this.freq=currentNotes[Math.floor(Math.random()*5)];
    this.life=1;
    this.sphereRPM=(this.layer===0?-0.12:this.layer===1?0.18:-0.15);
  }
  
  update() {
    const age=t-this.launchT;
    if(age<0) return;
    
    this.spinAngle+=this.rpm*0.01;
    this.sphereAngle=t*this.sphereRPM;
    
    this.z=500-Math.min(age*280,500);
    
    const windStrength=0.2+age*0.03+this.layer*0.1;
    this.windAngle+=0.12;
    
    const dx=-this.x*0.0008, dy=-this.y*0.0008;
    this.vx+=(Math.cos(this.windAngle)+dx+this.layer*0.02)*windStrength;
    this.vy+=(Math.sin(this.windAngle)+dy-this.layer*0.015)*windStrength;
    
    this.x+=this.vx;
    this.y+=this.vy;
    
    this.life=1-(this.z/500)*0.75;
    globalRPM=Math.max(globalRPM,this.rpm*0.001);
    
    if(this.life>0.88) playNote(this.freq);
  }
  
  project() {
    const dist=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);
    const fov=1400;
    const z=this.z+350;
    const sx=450+(this.x/z)*fov;
    const sy=450+(this.y/z)*fov;
    const scale=(fov/z)*0.35/Math.sqrt(dist/900);
    return {sx,sy,scale};
  }
  
  draw() {
    const p=this.project();
    if(p.scale<0.04||p.sx<-120||p.sx>1020||p.sy<-120||p.sy>1020) return;
    
    ctx.save();
    ctx.translate(p.sx,p.sy);
    ctx.rotate(this.spinAngle+this.sphereAngle);
    ctx.scale(p.scale,p.scale);
    ctx.globalAlpha=this.life;
    
    const hue=(this.freq*7+this.layer*90+t*20)%360;
    ctx.shadowColor=`hsla(${hue},100%,60%,1)`;
    ctx.shadowBlur=25+this.rpm*0.025+this.layer*10;
    
    const size=(this.layer+1)*2.5;
    ctx.fillStyle=`hsla(${hue},100%,75%,${this.life})`;
    ctx.fillRect(-8,-4,16,8);
    
    ctx.fillStyle=`hsla(${hue},100%,55%,${this.life*0.7})`;
    ctx.beginPath();
    ctx.arc(0,0,6,0,Math.PI*2);
    ctx.fill();
    
    ctx.strokeStyle=`hsla(${hue},100%,45%,${this.life*0.9})`;
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.arc(0,0,10,0,Math.PI*2);
    ctx.stroke();
    ctx.restore();
  }
}

function initAudio() {
  audioCtx=new AudioContext();
}

function playNote(freq) {
  if(!audioCtx||!audioUnlocked||audioCtx.state==='suspended') return;
  try {
    const osc=audioCtx.createOscillator();
    const gain=audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.frequency.value=freq;
    osc.type='sawtooth';
    gain.gain.setValueAtTime(0.24, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime+decay*0.65);
    osc.start(audioCtx.currentTime);
    osc.stop(audioCtx.currentTime+decay*0.65);
  } catch(e) {}
}

document.getElementById('unlock').onclick=()=>{
  initAudio();
  document.getElementById('unlock').style.display='none';
  audioUnlocked=true;
  loadPreset(0);
};

function loadPreset(i) {
  if(!audioUnlocked) return;
  preset=i;
  currentNotes=presets[i][0];
  decay=presets[i][1];
  songProgress=0;
  globalRPM=0;
  document.getElementById('preset').textContent=presets[i][2];
  particles=[];
}

function render() {
  t+=0.016;
  
  const launchTimes=songTiming[preset];
  if(t>launchTimes[songProgress%launchTimes.length]+0.12) {
    particles.push(new CNCTool(t));
    songProgress++;
  }
  
  ctx.fillStyle='rgba(0,4,18,0.3)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  
  ctx.save();
  ctx.translate(450,450);
  ctx.shadowColor='#0f0';
  ctx.shadowBlur=70+globalRPM*25;
  
  const grad=ctx.createRadialGradient(0,0,0,0,0,90+globalRPM*40);
  grad.addColorStop(0,'rgba(0,255,0,1)');
  grad.addColorStop(0.25,'rgba(0,160,0,0.95)');
  grad.addColorStop(0.6,'rgba(0,60,0,0.6)');
  grad.addColorStop(1,'transparent');
  ctx.fillStyle=grad;
  ctx.beginPath();
  ctx.arc(0,0,90+globalRPM*40,0,Math.PI*2);
  ctx.fill();
  ctx.restore();
  
  for(let i=particles.length-1;i>=0;i--) {
    particles[i].update();
    particles[i].draw();
    if(particles[i].life<0) particles.splice(i,1);
  }
  
  document.getElementById('notes').textContent=particles.length;
  document.getElementById('rpm').textContent=(globalRPM*100).toFixed(0);
  
  requestAnimationFrame(render);
}

if('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js');
}

render();
</script>
</body>
</html>
